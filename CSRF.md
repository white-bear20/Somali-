# CSRF学习笔记

<h2 id="menu">目录</h2>

* ### [什么是CSRF](#1)
* ### [XSS和CSRF的区别](#2)
* ### [CSRF攻击手法](#3)
* ### [防御方法](#4)
***

> <h2 id="1">什么是CSRF</h2>
    CSRF(Cross-site request forgery),中文名：跨站请求伪造，也被称为:one click attack/session riding,缩写为:CSRF/XSRF

> <h2 id="2">XSS和CSRF的区别</h2>
    XSS被称为跨站脚本攻击，CSRF为跨站请求伪造，其实我之前一直以外CSRF是XSS的一个分支，它们应该是同一类，但是现在回头再看，我觉得它们两个是两种完全不同的漏洞，包括漏洞出现的位置以及漏洞的利用手法，虽然可能有时候会有实现相同的功能但是这并不能说明什么。

    CSRF盗用了受害者的身份，并且以受害者的名义去发送恶意请求，这过程中目标服务器可能都看不到攻击者的影子，在它看来全是用户自己操作的，而且当用户一点，只要条件满足，那么攻击者想要达到的目的基本上是完成了，但是说回XSS，首先XSS是加载执行了恶意的JS代码，那么如果没有其他操作的话，当前的恶意代码是只会在漏洞页面执行的，那么当页面被关闭，XSS的利用也就无了，这时候可能攻击者的目的还没达到呢，

> <h2 id="3">CSRF攻击手法</h2>
    完成一次CSRF攻击，需要满足两个条件
        1.用户 受 被攻击网站的信任（在本地存有cookie）
        2.在受信任期间触发了CSRF漏洞
    
### 场景描述
#### 环境介绍
    存在CSRF漏洞的网站：WebA
    攻击者: WebB
    受害者: Tom
    
#### 攻击描述
    1.Tom浏览并登录了网站A
    2.通过网站A的验证后，网站A给Tom返回了一个Cookie
    3.Tom在没有登出A网站的情况下（或者cookie还有效的情况下）去访问了网站B
    4.这时网站B要求Tom去访问网站A（注意，这个的要求，可能并不是弹出一个框问Tom是否要去网站A，可能是网站B在背后向A发送了一个请求）
    5.根据B的请求，浏览器会带着网站A的Cookie去访问A
    6.网站A收到请求后，它并不知道这个请求是Tom发起的还是网站B发起的，但是由于请求中携带了之前给Tom的Cookie，所以网站A会根据用户的权限去处理请求
    7.这样攻击者就达到了模拟用户操作的目的

> <h2 id="4">防御手法</h2>
    将所有的表单都包含一个伪随机值，因为攻击者不能获得第三方的cookie，但是如果有XSS除外。
    判断Referer    
***
[返回顶部](#menu)